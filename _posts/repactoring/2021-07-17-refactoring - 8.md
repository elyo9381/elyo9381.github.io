---
layout: post
title: 리팩터링 리뷰 - 8
subtitle: "spring, security"
categories: spring
tags: security
comments: true
---
> repactoring

----
상속리팩터링
====

## 1. 메서드 올리기 

  - 부모 클래스에 특정메소드가 존재하는데 자식 클래스에도 같은 메서드가 존재할때 이땐 부모클래스에만 메서드를 정의하고 사용하면 된다.
  - 복잡한 상황은 해당 메서드의 본문에서 참조하는 필드들이 서브클래스에만 있는 경우다. 이런 경우라면 필드들 먼저 슈퍼클래스로 올린 후에 메서드를 올려야 한다


## 2. 필드 올리기 

  - 서브 클래스들이 독립적으로 개발되었거나 뒤늦게 하나의 계층구조로 리팩터링된 경우라면 필드 중복의 경우가 많이 발생한다. 
  - 네이밍 뿐만 아니라 의도 까지 말이다. 그렇기 때문에 비슷한 방식으로 생각되면 슈퍼클래스로 끌어올리자.

  - 필드 올리기 장점
    1. 데이터 중복 선언을 없앨 수 있다. 
    2. 해당 필드를 사용하는 동작을 서브클래스로 옮길 수 있다. 

## 3. 생성자 본문 올리기 

  - 서브 클래스들에서 기능이 같은 메서드들을 발견하면 함수 추출하기와 메서드 올리기를 적용해 슈퍼클래스로 옮기는게 좋다. 
  - 하지만 생성자라면 복잡하다. 생성자는 할수있는 일과 호출 순서에 제약이 존재하기 때문이다.

  절차
    1. 슈퍼클래스에 생성자가 없다면 하나 정의한다. 서브클래스의 생성자들에서 이 생성자가 호출되는지 확인한다.
    2. 문장 슬라이드하기로 공통 문장 모두를 super() 호출 직후로 옮긴다.
    3. 공통 코드를 슈퍼클래스에 추가하고 서브클래스들에서는 제거한다. 생성자 매개변수 중 공통 코드에서 참조하는 값들을 모두 super()로 건넨다.
    4. 테스트한다.
    5. 생성자 시작 부분으로 옮길 수 없는 공통 코드에는 함수 추출하기와 메서드 올리기를 차례로 적용한다.


## 4.메서드 내리기

  - 특정 서브클래스 하나 와만 관련된 메서드는 슈퍼클래스에서 제거하고 해당 서브클래스에 추가하는 편이 깔끔하다.

## 5.필드 내리기

  - 서브클래스 하나에서만 사용하는 필드는 해당 서브클래스로 옮긴다.


## 6. 타입코드를 서브클래스로 바꾸기

  - 타입코드는 프로그래밍 언어에 따라 열거형이나 심볼,문자열,숫자 등으로 표현하며, 외부 서비스가 제공하는 데이터를 다루려 할때 딸려오는 일이 흔하다.
  - 서브클래스는 두 가지 면에서 특히 매력적이다. 
    1. 조건에 따라 다르게 동작하도록 해주는 다형성을 제공한다. 서브클래스를 이용하면 이런 함수들에 조건부 로직을 다형성으로 바꾸기를 적용할 수 있다. 
    2. 특정 타입에서만 의미가 있는 값을 사용하는 필드나 메서드가 있을 때 발현된다. 


## 7. 서브클래스 제거하기 

  - 서브클래싱은 데이터 구조와는 다른 변종을 만들거나 종류에 따라 동작이 달라지게 할 수 있는 유용한 메커니즘이다. 

## 8. 슈퍼클래스 추출하기 

  - 비슷한 일을 수행하는 두 클래스가 보이면 상속 메커니즘을 이용해서 비슷한 부분을 공통의 슈퍼클래스로 옮겨 담을 수 있다. 
    - 메서드 올리기를 사용하자
  - 상속 관계를 만드는이유?
    - 정석: '현실 세계에서 활용하는 어떤 분류 체계에 기초하여 구현에 ...'
    - 실천: 글래스 짜다가 공통분모 있으면 수행
  
  절차
  1. 빈클래스 만들기
  2. 공통된 변수 및 메서드 옮기기 
  3. 테스트하기 


## 9. 계층 합치기

  - 계층구조도 진화하면서 어떤 클르스와 그 부모가 너무 비슷해져서 더는 독립적으로 존재해야 할 이유가 사라지는 경우가 생기기도 한다. 
  - 이러한 경우에 그 둘을 하나로 합쳐야 할 시점이다. 

  절차
  1. 두 클래스 중 제거 할 것을 고른다. 
  2. 필드올리기와 메서드 올리기 혹은 필드 내리기와 메서드 내리기를 적용하여 모든 요소를 하나의 클래스로 옮긴다.
  3. 제거할 클래스를 참조하던 모든 코드가 남겨질 클래스를 참조하도록 고친다. 
  4. 빈 클래스를 제거한다. 
  5. 테스트한다.

## 10. 서브 클래스를 위임으로 바꾸기
  
  - 상속의 단점은 한번만 쓸 수 있는 카드라는 것이다. 
  - 무언가 달라져야 하는 이유가 여러 개여도 상속에서는 그중 단 하나의 이유만 선택해 기준으로 삼을 수 밖에 없다.
  - 상속의 다른문제는 부모를 수정하면 자식도 수정되는 연계문제이다.
  
  - 위임은 이러한 문제를 모두 해결해준다. 
  - 위임은 객체 사이의 일반적인 관계이므로 상호작용에 필요한 인터페이스를 명확히 정의 할 수 있다. 
  - 즉 상속보다 결합도가 훨씬 약하다. 
  - 상속 관련 문제에 직면하면 흔히 서브클래스 위임으로 바꾼다.

  - '상속보다 컴포지션을 사용하라' 라는 문구가 있다. 
  - 컴포지션은 사실상 위임과 동일하다. 
  
