---
layout: post
title: jpa-concept-6
subtitle: "spring, framework, jpa"
categories: spring
tags: framework
comments: true
---
> spring jpa study

## 상속관계 매핑 
  * 관계형 데이터베이스는 상속 관계 X
  * 슈퍼타입 서브타입 관계라는 모델링 기법이 객체 상속과 유사
  * 상속관계 매핑 : 객체의 상속과 구조와 DB의 슈퍼타입 서브타입 관계를 매핑


  * 슈퍼타입 서브타입 논리모델을 실제 물리 모델로 구현하는 방법
    * 각각 테이블로 변환 -> 조인 전략 ( 가장 정규화된 방식 )
    * 통합 테이블로 변환 -> 단일 테이블 전략
    * 서브타입 테이블로 변환 -> 구현 클래스마다 테이블 전략

  * 조인전략(장점)
    * 테이블 정규화
    * 외래 키 참조 무결성 제약 조건 활용가능
    * 저장공간 효율화
    
  * 조인전략(단점)
    * 조회시 조인을 많이 사용, 성능저하
    * 조회 쿼리가 복잡함
    * 데이터 저장시 insert sql2번 호출

  * 단일테이블전략(장점)
    * 조인이 필요 없으므로 일반적으로 조회 성능이 빠름
    * 조회 쿼리가 단순함
    
  * 단일테이블전략(단점)
    * 자식 엔티티가 매핑한 컬럼은 모두 null허용
    * 단일 테이블에 모든 것을 저장하므로 테이블이 커질수 있고 상환에따라서 조회 성능이 오히려 느려질수있다.(임계점을 넘어야한다.)

  * 구현 클래스마다 테이블전략 -> 사용치 마라 

  ##### 어떤전략을 사용해야하나?
    이부분에서는 DB설계자와 잘 협의하여야한다. 기본적으로는 join전략을 사용하는게 좋다.   
    추후 비즈니스 로직이 추가될 것을 생각하면!!   
    하지만 간단한 테이블이고 추후 더 발전 가능성이 없다고 생각하면 단일테이블전략으로 가라 !!    


  * 실무에서 상속 관계를 쓰느냐??
    경우에 따라 다르다.   
    데이터가 많아지면 테이블이 단순해야한다.    
    

## @MappedSuperclass
  * 공통 매핑 정보가 존재할때 속성만 상속해서 사용하고 싶을때 ( 디비는 각각 다르다 ) 객체에서만 속성을 묶는것

  * 상속관계 매핑 X
  * 엔티티 X, 테이블과 매핑X
  * 부모클래스를 상속 받는 자식 클래스에 매핑 정보만 제공
  * 조회,검색 불가(em.find(BaseEntity)불가)
  * 직접 생성해서 사용할 일이 없으므로 추상 클래스 권장

  


